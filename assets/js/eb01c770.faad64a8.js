"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[7469],{1517:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>d,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var a=n(5893),s=n(1151);const r={},d="Ore",l={id:"Hackthebox/Sherlocks/Ore/index",title:"Ore",description:'One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named "xmrig". Important Information Our organisation\'s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance.',source:"@site/docs/Hackthebox/Sherlocks/Ore/index.md",sourceDirName:"Hackthebox/Sherlocks/Ore",slug:"/Hackthebox/Sherlocks/Ore/",permalink:"/Target-Machines-WriteUp/docs/Hackthebox/Sherlocks/Ore/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Hackthebox/Sherlocks/Ore/index.md",tags:[],version:"current",frontMatter:{},sidebar:"Hackthebox_Sidebar",previous:{title:"Meerkat",permalink:"/Target-Machines-WriteUp/docs/Hackthebox/Sherlocks/Meerkat/"},next:{title:"Tracer",permalink:"/Target-Machines-WriteUp/docs/Hackthebox/Sherlocks/Tracer/"}},i={},o=[{value:"\u9898\u76ee\u6570\u636e",id:"\u9898\u76ee\u6570\u636e",level:2},{value:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",id:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",level:2},{value:"Task 1",id:"task-1",level:2},{value:"Task 2",id:"task-2",level:2},{value:"Task 3",id:"task-3",level:2},{value:"Task 4",id:"task-4",level:2},{value:"Task 5",id:"task-5",level:2},{value:"Task 6",id:"task-6",level:2},{value:"Task 7",id:"task-7",level:2},{value:"Task 8",id:"task-8",level:2},{value:"Task 9",id:"task-9",level:2},{value:"Task 10",id:"task-10",level:2},{value:"Task 11",id:"task-11",level:2},{value:"Task 12",id:"task-12",level:2},{value:"Task 13",id:"task-13",level:2},{value:"Task 14",id:"task-14",level:2}];function p(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components},{Details:r}=t;return r||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"ore",children:"Ore"}),"\n",(0,a.jsxs)(t.admonition,{title:"Sherlock Scenario",type:"info",children:[(0,a.jsx)(t.p,{children:'One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named "xmrig". Important Information Our organisation\'s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance.'}),(0,a.jsx)(t.p,{children:'\u6211\u4eec\u7684\u6280\u672f\u5408\u4f5c\u4f19\u4f34\u76ee\u524d\u6b63\u5728\u7ba1\u7406\u6211\u4eec\u7684 AWS \u57fa\u7840\u8bbe\u65bd\u3002\u6211\u4eec\u8bf7\u6c42\u5c06\u67d0\u4e9b\u6280\u672f\u90e8\u7f72\u5230\u4e91\u4e2d\u3002\u6240\u63d0\u51fa\u7684\u89e3\u51b3\u65b9\u6848\u662f\u6258\u7ba1 Grafana \u5e94\u7528\u7684\u4e00\u4e2a EC2 \u5b9e\u4f8b\u3002\u5728 EC2 \u90e8\u7f72\u540e\u4e0d\u4e45\uff0cCPU \u4f7f\u7528\u7387\u5c31\u6301\u7eed\u8fbe\u5230\u4e86 98% \u4ee5\u4e0a\uff0c\u4e00\u4e2a\u540d\u4e3a "xmrig" \u7684\u8fdb\u7a0b\u5bfc\u81f4\u3002\u91cd\u8981\u4fe1\u606f\uff1a\u6211\u4eec\u7ec4\u7ec7\u529e\u516c\u5ba4\u7684\u516c\u7f51 IP \u662f 86.5.206.121\uff0c\u5728\u90e8\u7f72\u5e94\u7528\u540e\uff0c\u6211\u4eec\u8fdb\u884c\u4e86\u4e00\u4e9b\u57fa\u672c\u7684\u6f0f\u6d1e\u6d4b\u8bd5\u548c\u7ef4\u62a4\u3002'})]}),"\n",(0,a.jsx)(t.h2,{id:"\u9898\u76ee\u6570\u636e",children:"\u9898\u76ee\u6570\u636e"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(5554).Z+"",children:"ore.zip"})}),"\n",(0,a.jsx)(t.h2,{id:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",children:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3"}),"\n",(0,a.jsx)(t.p,{children:"\u7ecf\u8fc7\u5206\u6790\uff0c\u672c\u9644\u4ef6\u4e3b\u8981\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5f00\u6e90\u9879\u76ee\u7684\u6587\u4ef6"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://github.com/grafana/grafana",children:"grafana"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"https://github.com/WithSecureLabs/LinuxCatScale",children:"Linux-CatScale"})}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"grafana"})," \u7684\u6587\u4ef6\u4f4d\u4e8e ",(0,a.jsx)(t.code,{children:".\\usr\\share\\grafana"})," \u6587\u4ef6\u5939\u5185\uff0c\u6709\u4ee5\u4e0b\u6587\u4ef6"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"Mode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----          2022/11/24    23:53                .cache\nd----          2022/11/24    23:53                .config\nd----          2022/11/24    23:53                .gnupg\nd----          2022/11/24    23:53                .local\nd----          2022/11/24    23:53                bin\nd----          2022/11/24    23:53                conf\nd----          2022/11/24    23:53                data\nd----          2022/11/24    23:53                plugins-bundled\nd----          2022/11/24    23:53                public\nd----          2022/11/24    23:53                scripts\n-----          2022/11/24    23:53           3348 .bash_history\n-----          2022/11/24    23:53             66 .selected_editor\n-----          2022/11/24    23:53           8809 .viminfo\n-----          2022/11/24    23:53              5 VERSION\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="\u6587\u4ef6\u5939\u7ed3\u6784\u6811"',children:"D:.\n\u251c\u2500.cache - \u7f13\u5b58\n\u251c\u2500.config\n\u2502  \u2514\u2500lxc - lxc \u914d\u7f6e\u6587\u4ef6\n\u251c\u2500.gnupg - gnupg \u914d\u7f6e\u6587\u4ef6\n\u2502  \u2514\u2500private-keys-v1.d\n\u251c\u2500.local\n\u2502  \u2514\u2500share\n\u2502      \u2514\u2500nano\n\u251c\u2500bin - grafana \u4e8c\u8fdb\u5236\u7a0b\u5e8f\n\u251c\u2500conf - grafana \u914d\u7f6e\u6587\u4ef6\n\u2502  \u2514\u2500provisioning - \u5404\u4e2a\u7ec4\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\n\u2502      \u251c\u2500access-control\n\u2502      \u251c\u2500dashboards\n\u2502      \u251c\u2500datasources\n\u2502      \u251c\u2500notifiers\n\u2502      \u2514\u2500plugins\n\u251c\u2500data - grafana \u6570\u636e\u5b58\u653e\u76ee\u5f55\n\u2502  \u251c\u2500csv\n\u2502  \u251c\u2500log - grafana \u65e5\u5fd7\u76ee\u5f55\n\u2502  \u251c\u2500plugins\n\u2502  \u2514\u2500png\n\u251c\u2500plugins-bundled - \u63d2\u4ef6\u76ee\u5f55\n\u2502  \u2514\u2500internal\n\u2502      \u2514\u2500input-datasource\n\u2502          \u2514\u2500img\n\u251c\u2500public - grafana \u670d\u52a1\u7aef web \u76f8\u5173\u6587\u4ef6\n\u2514\u2500scripts - grafana \u542f\u52a8\u811a\u672c\n"})}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"Linux-CatScale"})," \u7684\u6587\u4ef6\u4f4d\u4e8e ",(0,a.jsx)(t.code,{children:"catscale_ip-172-31-13-147-20221124-1501.tar.gz"})," \u538b\u7f29\u5305\u5185\uff0c\u89e3\u538b\u540e\u5f97\u5230"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"Mode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----          2022/11/24    23:01                Docker\nd----          2022/11/24    23:02                Logs\nd----          2022/11/24    23:08                Misc\nd----          2022/11/24    23:07                Persistence\nd----          2022/11/24    23:01                Podman\nd----          2022/11/24    23:07                Process_and_Network\nd----          2022/11/24    23:07                System_Info\nd----          2022/11/24    23:01                User_Files\nd----          2022/11/24    23:01                Virsh\n-a---          2022/11/24    23:07           1804 ip-172-31-13-147-20221124-1501-console-error-log.txt\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="\u6587\u4ef6\u5939\u7ed3\u6784\u6811"',children:"D:.\n\u251c\u2500Docker - docker \u76f8\u5173\u4fe1\u606f\n\u251c\u2500Logs - `/var/log` \u76ee\u5f55\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\n\u251c\u2500Misc - \u5176\u4ed6\u76ee\u5f55\u4e0b\u7684\u65e5\u5fd7\u4fe1\u606f\n\u251c\u2500Persistence - \u6d89\u53ca\u5230\u6301\u4e45\u5316\u653b\u51fb\u7684\u76f8\u5173\u65e5\u5fd7\n\u251c\u2500Podman - podman \u76f8\u5173\u4fe1\u606f\n\u251c\u2500Process_and_Network - \u8fdb\u7a0b\u4e0e\u7f51\u7edc\n\u251c\u2500System_Info - \u7cfb\u7edf\u4fe1\u606f\n\u251c\u2500User_Files - \u7528\u6237\u7684\u6587\u4ef6\n\u2514\u2500Virsh - Virsh kvm \u76f8\u5173\u4fe1\u606f\n"})}),"\n",(0,a.jsxs)(t.p,{children:["\u7531\u4e8e ",(0,a.jsx)(t.code,{children:"Linux-CatScale"})," \u4f1a\u5bf9\u4e00\u4e9b\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u8fdb\u884c\u538b\u7f29\u5904\u7406\uff0c\u6240\u4ee5\u5f00\u59cb\u5904\u7406\u4e4b\u524d\u5148\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u7684\u538b\u7f29\u6587\u4ef6\u8fdb\u884c\u89e3\u538b\u7f29\u5904\u7406"]}),"\n",(0,a.jsx)(t.h2,{id:"task-1",children:"Task 1"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u54ea\u4e2a CVE \u5bfc\u81f4\u4e86 EC2 \u7684\u521d\u59cb\u59a5\u534f\uff1f"}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["\u5728 ",(0,a.jsx)(t.code,{children:".\\grafana\\data\\log\\grafana.log.2022-11-18.001"})," \u6587\u4ef6\u4e2d\uff0c\u53d1\u73b0\u4ee5\u4e0b\u8bb0\u5f55"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title=".\\grafana\\data\\log\\grafana.log.2022-11-18.001"',children:'t=2022-11-17T14:40:55+0000 lvl=info msg="Request Completed" logger=context userId=1 orgId=1 uname=admin method=GET path=/api/live/ws status=0 remote_addr=89.247.167.247 time_ms=1 size=0 referer=\n'})}),"\n",(0,a.jsx)(t.p,{children:"\u501f\u7531\u5173\u952e\u8bcd\u641c\u7d22\uff0c\u53ef\u4ee5\u786e\u5b9a\u662f grafana \u7684\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u7f16\u53f7"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"CVE-2021-43798\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-2",children:"Task 2"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u8bf7\u8be6\u7ec6\u8bf4\u660e\u5a01\u80c1\u884c\u4e3a\u8005\uff08TA\uff09\u7528\u4e8e\u9488\u5bf9\u6211\u4eec\u7ec4\u7ec7\u7684\u6240\u6709\u6076\u610f IP \u5730\u5740\u3002"}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["\u8fd9\u91cc\u805a\u7126\u4e8e ",(0,a.jsx)(t.code,{children:"grafana"})," \u7684\u65e5\u5fd7\u6587\u4ef6\u8fdb\u884c\u5206\u6790"]}),"\n",(0,a.jsxs)(t.admonition,{title:"\u6ce8\u610f\u529e\u516c\u5ba4\u7684\u516c\u7f51 ip \u5730\u5740",type:"note",children:[(0,a.jsx)(t.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u80cc\u666f\u4fe1\u606f\u91cc\u9762\u5df2\u7ecf\u63d0\u4f9b\u4e86\u529e\u516c\u5ba4\u7684\u516c\u7f51 IP\uff0c\u5e94\u8be5\u5728\u6076\u610f\u540d\u5355\u5185\u53bb\u9664\u8fd9\u4e2a ip \u5730\u5740"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"86.5.206.121\n"})})]}),"\n",(0,a.jsx)(t.p,{children:"\u9996\u5148\uff0c\u5148\u4f7f\u7528 python \u811a\u672c\u7b5b\u9009\u4e00\u4e0b web \u8bbf\u95ee\u7684\u8def\u5f84"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'for index in range(18, 25):\n    with open("./grafana.log.2022-11-{}.001".format(index), "r") as f:\n        log_data = f.read()\n    log_data = log_data.split("\\n")\n    for i in log_data:\n        if "86.5.206.121" not in i and "remote_addr" in i and "Request Completed" in i:\n            info_1 = i.split(\'"\')\n            info_2 = [i for i in info_1[2].split(" ") if i.startswith(("path", "remote_addr"))]\n            if info_2[0] in ["path=/", "path=/login", "path=/api/search"]:\n                continue\n            print(info_1[1], " ".join(info_2))\n'})}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:" \u811a\u672c\u8f93\u51fa\u7684\u7ed3\u679c "}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"Request Completed path=/ remote_addr=89.247.167.247\nRequest Completed path=/api/user/password/reset remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/etc/passwd remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/grafana.ini remote_addr=89.247.167.247\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/ remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/ remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.31.99.194\nRequest Completed path=/login remote_addr=86.31.99.194\nRequest Completed path=/login remote_addr=85.255.236.29\nRequest Completed path=/login remote_addr=213.205.198.177\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=92.40.168.226\nRequest Completed path=/login remote_addr=86.24.222.206\nRequest Completed path=/login remote_addr=62.254.9.100\nRequest Completed path=/login remote_addr=87.80.124.243\nRequest Completed path=/login remote_addr=45.133.172.63\nRequest Completed path=/login remote_addr=188.241.82.31\nRequest Completed path=/login remote_addr=188.241.82.31\nRequest Completed path=/login remote_addr=212.102.35.14\nRequest Completed path=/login remote_addr=212.102.35.14\nRequest Completed path=/login remote_addr=181.214.218.45\nRequest Completed path=/login remote_addr=181.214.218.45\nRequest Completed path=/login remote_addr=212.102.36.3\nRequest Completed path=/login remote_addr=156.146.60.29\nRequest Completed path=/login remote_addr=156.146.60.29\nRequest Completed path=/login remote_addr=216.24.213.40\nRequest Completed path=/login remote_addr=194.32.122.58\nRequest Completed path=/ remote_addr=71.6.232.20\nRequest Completed path=/ remote_addr=193.118.53.210\nRequest Completed path=/login remote_addr=193.118.53.210\nRequest Completed path=/ remote_addr=198.235.24.155\nRequest Completed path=/login remote_addr=198.235.24.155\nRequest Completed path=/login remote_addr=78.146.160.14\nRequest Completed path=/ remote_addr=205.210.31.132\nRequest Completed path=/ remote_addr=205.210.31.51\nRequest Completed path=/login remote_addr=205.210.31.51\nRequest Completed path=/login remote_addr=44.192.62.21\nRequest Completed path=/login remote_addr=89.247.167.246\nRequest Completed path=/login remote_addr=89.247.167.246\nRequest Completed path=/ remote_addr=89.247.167.246\nRequest Completed path=/api/live/ws remote_addr=89.247.167.246\nRequest Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=89.247.167.246\nRequest Completed path=/api/dashboards/home remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/plugins remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/frontend-metrics remote_addr=89.247.167.246\nRequest Completed path=/login remote_addr=87.80.124.243\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=/login remote_addr=95.181.232.32\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=\nRequest Completed path=/public/plugins/alertlist/../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/shadow remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/config/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/template.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/login remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=195.80.150.137\nRequest Completed path=/ remote_addr=195.80.150.137\nRequest Completed path=/login remote_addr=195.80.150.137\nRequest Completed path=/login remote_addr=195.80.150.137\nRequest Completed path=/ remote_addr=195.80.150.137\nRequest Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=195.80.150.137\nRequest Completed path=/api/live/ws remote_addr=195.80.150.137\nRequest Completed path=/api/dashboards/home remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/plugins remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/live/list remote_addr=195.80.150.137\nRequest Completed path=/api/frontend-metrics remote_addr=195.80.150.137\nRequest Completed path=/api/users/search remote_addr=195.80.150.137\nRequest Completed path=/avatar/7948431d6e0557fd0c57d91a7cd50cad remote_addr=195.80.150.137\nRequest Completed path=/api/dashboards/tags remote_addr=195.80.150.137\nRequest Completed path=/api/search/sorting remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\n"})}),(0,a.jsx)(t.p,{children:"\u7ecf\u8fc7\u7b5b\u9009\uff0c\u53ef\u4ee5\u5f97\u5230ip\u6570\u636e\u7684\u96c6\u5408"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"89.247.167.247     11\n86.24.61.7         14\n86.31.99.194       2\n85.255.236.29      1\n213.205.198.177    1\n92.40.168.226      1\n86.24.222.206      1\n62.254.9.100       1\n87.80.124.243      2\n45.133.172.63      1\n188.241.82.31      2\n212.102.35.14      2\n181.214.218.45     2\n212.102.36.3       1\n156.146.60.29      2\n216.24.213.40      1\n194.32.122.58      1\n71.6.232.20        1\n193.118.53.210     2\n198.235.24.155     2\n78.146.160.14      1\n205.210.31.132     1\n205.210.31.51      2\n44.192.62.21       1\n89.247.167.246     13\n95.181.232.32      25\n195.80.150.137     22\n"})})]}),"\n",(0,a.jsx)(t.p,{children:"\u518d\u4f7f\u7528\u811a\u672c\uff0c\u5bf9\u767b\u9646\u5931\u8d25\u7684\u8bb0\u5f55\u8fdb\u884c\u7b5b\u9009"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'ips = {}\n\nfor index in range(18, 25):\n    with open("./grafana.log.2022-11-{}.001".format(index), "r") as f:\n        log_data = f.read()\n    log_data = log_data.split("\\n")\n    for i in log_data:\n        if "86.5.206.121" not in i and "remote_addr" in i and "Invalid username or password" in i:\n            info_1 = i.split(\'"\')\n            info_2 = [i for i in info_1[2].split(" ") if i.startswith(("remote_addr"))]\n            print(info_1[1], " ".join(info_2))\n            ip = [i for i in i.split(" ") if i.startswith(("remote_addr"))][0].split("=")[1]\n            if ip in ips.keys():\n                ips[ip] += 1\n            else:\n                ips[ip] = 1\n\nfor i in ips.keys():\n    print(str(i).ljust(18," "), ips[i])\n'})}),"\n",(0,a.jsx)(t.p,{children:"\u5f97\u5230\u4ee5\u4e0bip\u7684\u96c6\u5408"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"86.24.61.7         11\n86.31.99.194       1\n95.181.232.32      1\n"})}),"\n",(0,a.jsx)(t.p,{children:"\u5bf9\u4ee5\u4e0a\u63d0\u53d6\u51fa\u6765\u7684ip\u96c6\u5408\u8fdb\u884c\u4eba\u5de5\u7814\u5224\uff0c\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{style:{textAlign:"center"},children:"ip\u5730\u5740"}),(0,a.jsx)(t.th,{style:{textAlign:"center"},children:"\u884c\u4e3a"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"89.247.167.247"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"api\u8bbf\u95ee\uff0c\u5bc6\u7801\u91cd\u7f6e\uff0c\u8def\u5f84\u7a7f\u8d8a"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"86.24.61.7"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"\u5927\u91cf\u767b\u9646\u5c1d\u8bd5\uff08\u9519\u8bef\u7684\u7f51\u5740\uff09\uff0c\u653b\u51fb\u6027\u8f83\u4f4e"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"89.247.167.246"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"api\u8bbf\u95ee\uff08\u9519\u8bef\u7684\u7f51\u5740\uff09\uff0c\u653b\u51fb\u6027\u8f83\u4f4e"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"95.181.232.32"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"\u8def\u5f84\u7a7f\u8d8a"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"195.80.150.137"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"\u8def\u5f84\u7a7f\u8d8a\uff0c\u5927\u91cfapi\u8bbf\u95ee"})]})]})]}),"\n",(0,a.jsx)(t.p,{children:"\u5c06\u4e0a\u9762\u7684ip\u5730\u5740\u8fdb\u884c\u5347\u5e8f\u6392\u5e8f\uff0c\u5f97\u5230"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"89.247.167.247,95.181.232.32,152.89.239.97,195.80.150.137\n"})}),"\n",(0,a.jsx)(t.p,{children:"\u6839\u636e\u6570\u636e\uff0c\u8fdb\u884c\u5206\u7ec4\u7206\u7834\u7b54\u6848"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",children:"89.247.167.247,95.181.232.32,195.80.150.137\n195.80.150.137,89.247.167.247,95.181.232.32\n89.247.167.247,95.181.232.32\n95.181.232.32,195.80.150.137\n89.247.167.247,195.80.150.137\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-3",children:"Task 3"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u8d26\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4ee5\u8bbf\u95ee\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\uff1f"}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["\u5c06 ",(0,a.jsx)(t.code,{children:".\\catscale_out\\Logs\\ip-172-31-13-147-20221124-1501-var-log.tar.gz"})," \u6587\u4ef6\u8fdb\u884c\u89e3\u538b\u7f29\uff0c\u5728\u5176\u4e2d\u627e\u5230 ",(0,a.jsx)(t.code,{children:"auth.log"})," \u8fd9\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d\u6240\u8bb0\u5f55\u7684\u662f\u7cfb\u7edf\u7684\u9274\u6743\u65e5\u5fd7\uff0c\u5728 sshd \u90e8\u5206\u5c31\u53ef\u4ee5\u770b\u5230\u76f8\u5173\u9274\u6743\u65e5\u5fd7"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="auth.log"',children:'Nov 23 11:17:18 ip-172-31-60-25 sshd[6105]: Accepted password for grafana from 195.80.150.137 port 52172 ssh2"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"grafana\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-4",children:"Task 4"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:'TA \u4fee\u6539\u4e86\u54ea\u4e2a\u6587\u4ef6\u4ee5\u63d0\u5347\u6743\u9650\u5e76\u4ee5 "root" \u8eab\u4efd\u8fd0\u884c\u6316\u77ff\u670d\u52a1\uff1f'}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-5",children:"Task 5"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u7a0b\u5e8f\u4e0b\u8f7d\u4e86 injector.sh \u811a\u672c\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"wget\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-6",children:"Task 6"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u6700\u521d\u5c06\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\u4e0b\u8f7d\u5230\u4e86\u54ea\u91cc\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-7",children:"Task 7"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u7a0b\u5e8f\u540c\u65f6\u4e0b\u8f7d\u4e86\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-8",children:"Task 8"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u6211\u4eec\u9700\u8981\u786e\u8ba4 SOC \u56e2\u961f\u5f00\u59cb\u6536\u96c6\u8bc1\u636e\u7684\u786e\u5207\u65f6\u95f4\uff0c\u56e0\u4e3a\u62a5\u544a\u4e2d\u6ca1\u6709\u5305\u542b\u6b64\u4fe1\u606f\u3002\u4ed6\u4eec\u4f7f\u7528\u4e0e\u6211\u4eec\u6797\u80af\u7cfb\u7edf\u7ba1\u7406\u5458\u76f8\u540c\u7684\u516c\u7f51 IP \u5730\u5740\u3002"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-9",children:"Task 9"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u8bf7\u786e\u8ba4\u7cfb\u7edf\u7ba1\u7406\u5458\u5728\u67d0\u4e9b Grafana \u914d\u7f6e\u6587\u4ef6\u4e2d\u7559\u4e0b\u7684\u5bc6\u7801\u3002"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="\\grafana\\conf\\defaults.ini"',children:"# default admin password, can be changed before first start of grafana, or in profile settings\nadmin_password = f0rela96789!\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"f0rela96789!\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-10",children:"Task 10"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u5f53\u542f\u52a8 xmrig \u65f6\uff0c\u6316\u77ff\u7ebf\u7a0b\u503c\u8bbe\u7f6e\u4e3a\u591a\u5c11\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="./catscale_ip-172-31-13-147-20221124-1501/catscale_out/Process_and_Network/ip-172-31-13-147-20221124-1501-processes-axwwSo.txt"',children:"root      1089     1 2829088 9944 ?        Ssl  14:32 00:29:28 /usr/share/.logstxt/xmrig -c /usr/share/.logstxt/config.json -- threads=0\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"0\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-11",children:"Task 11"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u6211\u4eec\u7684 CISO \u8981\u6c42\u83b7\u53d6\u6709\u5173\u53ef\u80fd\u4f7f\u7528\u7684\u6316\u77ff\u6c60\u7684\u5176\u4ed6\u7ec6\u8282\u3002\u8bf7\u786e\u8ba4 TA \u4f7f\u7528\u4e86\u54ea\u4e2a\uff08\u5982\u679c\u6709\uff09\u6316\u77ff\u6c60\u3002"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-12",children:"Task 12"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u6211\u4eec\u65e0\u6cd5\u5728\u539f\u59cb\u4e0b\u8f7d\u4f4d\u7f6e\u627e\u5230\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\u3002TA \u5c06\u5b83\u4eec\u79fb\u52a8\u5230\u6587\u4ef6\u7cfb\u7edf\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Task 10 \u5c31\u6709"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"',children:"/usr/share/.logstxt/\n"})}),"\n",(0,a.jsx)(t.h2,{id:"task-13",children:"Task 13"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u6211\u4eec\u65e0\u6cd5\u8fdb\u884c\u53d6\u8bc1\u5730\u6062\u590d\u7528\u4e8e\u5206\u6790\u7684 \u201cinjector.sh\u201d \u811a\u672c\u3002\u6211\u4eec\u8ba4\u4e3a TA \u53ef\u80fd\u8fd0\u884c\u4e86\u4e00\u4e2a\u547d\u4ee4\uff0c\u963b\u6b62\u6211\u4eec\u6062\u590d\u8be5\u6587\u4ef6\u3002TA \u8fd0\u884c\u4e86\u54ea\u4e2a\u547d\u4ee4\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,a.jsx)(t.h2,{id:"task-14",children:"Task 14"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"\u7531\u6211\u4eec\u7684 IT \u7ba1\u7406\u5458\u521b\u5efa\u7684 cronjob \u4e3a TA \u4fee\u6539\u7684\u811a\u672c\u8fd0\u884c\u591a\u9891\u7e41\uff1f"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})})]})}function c(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},5554:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/ore-9fcda3ca8f273e1639dc8acb820c724a.zip"},1151:(e,t,n)=>{n.d(t,{Z:()=>l,a:()=>d});var a=n(7294);const s={},r=a.createContext(s);function d(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),a.createElement(r.Provider,{value:t},e.children)}}}]);